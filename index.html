<!DOCTYPE html>
<html>

<head>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="apple-touch-icon" href="launch.png">
  <link rel="apple-touch-startup-image" href="launch.png">
  <meta name="apple-mobile-web-app-title" content="Push To Telescope">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <style>
    body {
      background-color: black;
      color: red;
      font-family: verdana;
      font-size: 120%;
    }

    button {
      background-color: black;
      color: red;
      font-family: verdana;
      font-size: 3vw;
      border: 1px solid red;
      padding: 2% 2%;
      text-align: left;
    }

    .group7 {
      width: 12.5%;
    }

    .group8 {
      width: 10.5%;
    }

    .pressed {
      background-color: #880000;
    }
    }
  </style>


</head>

<body>
  <h2 id="topic"></h2>
  <div id="maori">Maori</div>
  <div id="english">English</div>
  <div id="buttons"></div>
  <script>
    addEventListener('load', function(e) {

cl=(arg)=>console.log(arg)
makeObject=(array,names)=>{
  o={}
  names.map((v,i)=>o[v]=array[i])
  return o
}
shuffle = (a, b) => Math.random() - 0.5


//MODEL


patternIndex=0
question=true
message=""

patternsCSV=[
 "how many [relation] do you have,tokohia āu [relation],I have [cardinal] [relation],[cardinal] (t)ōku [relation]",
  "how are you feeling?,kei te pehea koe,I am feeling [feeling],kei te [feeling] ahau",
  "where are you from?,nō hea koe,I am from [place],nō [place] ahau"

   ]

tupuCSV=[
  "place,Dunedin,Onetāhi",
  "place,Auckland,Tamaki Makaurau",
  "place,One Tree Hill,Maungakiekie",
  "feeling,happy,hari",
  "feeling,bored,hōhā",
  "feeling,sick,māuiui",
  "feeling,angry,pukuriri",
  "feeling,sleepy,hiamoe",
  "feeling,surprised,ohorere",
  "feeling,overjoyed,harikoa",
  "feeling,confused,rangirua",
  "feeling,hot,wera",
  "feeling,cold,makariri",
  "feeling,good,pai",
  "cardinal,one,kotahi",
  "cardinal,two,rua",
  "cardinal,three,toru",
  "relation,father,matua",
  "relation,mother,whaea"
  ]

patterns=[]
patternsCSV.forEach(v=>patterns.push(makeObject(v.split(","),["englishQ","maoriQ","englishA","maoriA"])))

tupus=[]
tupuCSV.forEach(v=>tupus.push(makeObject(v.split(","),["topic","english","maori"])))
  
wordsFromMaoriQuestion=()=>{
  return substituteMaoriVariableWord(patterns[patternIndex].maoriQ).split(" ")
}

wordsFromMaoriAnswer=()=>{
  return substituteMaoriVariableWord(patterns[patternIndex].maoriA).split(" ")
}

maoriWordList=()=>{
  list=[]
  patterns.forEach(v=>list=[...list,...v.maoriQ.split(" ")])
  return list
}

maoriWords = () => {
  if (question) {
    words=wordsFromMaoriQuestion()}
  else{
    words=wordsFromMaoriAnswer()}
  words=[...words,...maoriWordList()]
  words=[...new Set(words)]
  words=words.sort()
  return words
  //numberWordsCurrent = wordsCurrent.length
  //m = m.filter(v => !wordsCurrent.includes(v)).
    //sort(shuffle).slice(0, 8 - numberWordsCurrent)
}

substituteEnglishVariableWord=(str)=>{
  variableWord=str.match(/\[(\w+)\]/)
  if (variableWord!=null) {
    s=str.replace("["+variableWord[1]+"]",
      tupus.filter(v=>v.topic==variableWord[1])[0].english)
    return s
  }
  else{
    return str
  }
}

substituteMaoriVariableWord=(str)=>{
  variableWord=str.match(/\[(\w+)\]/)
  if (variableWord!=null) {
    s=str.replace("["+variableWord[1]+"]",
      tupus.filter(v=>v.topic==variableWord[1])[0].maori)
    return s
  }
  else{
    return str
  }
}

//VIEW


addElement=(id,elementType,container,width,text)=>{
  element=document.createElement(elementType)
  if (elementType=="button") element.style.cssText= buttonStyle
    else element.style.cssText=style
  element.style.width=width+"%"
  element.id=id
  element.innerHTML=text
  container.appendChild(element)  
  return element
}

buttonStyle="color:black;border-style:solid;border-width:1px;"+
  "font-size:5vw;font-family:verdana"
style="color:black;border-style:none;border-width:1px;"+
  "font-size:3vw;font-family:verdana"

showEnglishQuestion=()=>{
  maoriSentenceText=""
  englishSentenceText=
    substituteEnglishVariableWord(patterns[patternIndex].englishQ)
  message=""
  gridWords=maoriWords()
  question=!question
  display()
}

showEnglishAnswer=()=>{
  maoriSentenceText=""
  message=""
  englishSentenceText=
    substituteEnglishVariableWord(patterns[patternIndex].englishA)
  gridWords=maoriWords()
question=!question
  display()
}

display=()=>{
  document.body.innerHTML=""
  b=addElement(1,"div",document.body,100,"")
  b.addEventListener("click",clicked)
  nextPatternButton=addElement("nextPatternButton","button",b,33,"next")
  englishSentence=addElement("englishSentence",
    "div",b,100,englishSentenceText)
  messageButton=addElement("message","div",b,20,message)
  maoriSentenceElement=addElement("maoriSentence","div",
    b,80,maoriSentenceText)
  wordGrid=addElement("wordGrid","div",b,100,"")
  gridWords.forEach((v,i)=>addElement("tupu"+i,"button",wordGrid,20,v))

}

//CONTROLLER



clicked=e=>{ 
  id=e.target.id
  if (id=="nextPatternButton") {
    if (question) {
      patternIndex++ 
      showEnglishQuestion()
    }
    else {
      showEnglishAnswer()
    }
  }
 if (id.includes("tupu")) {
    maoriSentenceText=maoriSentenceText+gridWords[id.match(/\d/g)]+" "

    if (maoriSentenceText.trim()==patterns[patternIndex].maoriQ.toLowerCase()||
maoriSentenceText.trim()==substituteMaoriVariableWord(patterns[patternIndex].maoriA))  
      message="c"
  }

  display()
}

showEnglishQuestion()

})

/*

    
    sentence("aotearoa", "Ko wai tōu ingoa?", "What is your name?")
    sentence("aotearoa", "Ko [my name] tōku ingoa", "My name is [my name] ")
    sentence("aotearoa", "Ko wai tōna ingoa", "What is their name")
    sentence("aotearoa", "Nō hea koe?", "Where do you come from?")
    sentence("aotearoa", "Nō Oranga ahau", "I come from Oranga")
    sentence("aotearoa", "Kei te pēhea koe?", "How are you?")
    sentence("aotearoa", "Kei te [feeling] ahau", "I am [feeling]")
    sentence("aotearoa", "E pēhea ana koe?", "How are you?")
    sentence("aotearoa", "E [feeling] ana ahau", "I am [feeling]")
    sentence("aotearoa", "Ki te taha o tōku matua", "On my Dad's side")
    sentence("aotearoa", "Ko [name] tōku koro", "My grandfather is [name]")
    sentence("aotearoa", "Ko wai ō tuakāna?", "Who are your older siblings of same gender?")
    sentence("aotearoa", "Ko wai hoa rangitira?", "Who is your spouse?")
    sentence("aotearoa", "Ko [name] rāua ko [name] ōku tuakāna?", "[Name] and [name] are my older siblings of same gender?")
    sentence("aotearoa", "Kaore ōku teina", "I have no younger siblings of same gender?")
    sentence("aotearoa", "Kotahi tōku teina", "I have one younger siblings of same gender?")
    
    sentence("whakapapa", "Tokohia ngā tamariki o Kuini?", "How many children does the queen have?")
    sentence("whakapapa", "Tokohia āu tuakana", "How many older siblings of your gender do you have")

single user

where are you from
grid: ahua hea koe no ...
no hea koe
  
i am from dunedin
grid: ahau koe no onetahi
no Onetahi ahau

Two users

...



 */
  </script>
</body>

</html>
