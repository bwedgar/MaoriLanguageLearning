<!DOCTYPE html>
<html>

<head>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="apple-touch-icon" href="launch.png">
  <link rel="apple-touch-startup-image" href="launch.png">
  <meta name="apple-mobile-web-app-title" content="Korero">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <script type="text/javascript" src="../mespeakmaori/mespeak-core.js"></script>
  <script type="text/javascript" src="../mespeakmaori/mespeak.js?v=2.0.4"></script>
  <script type="text/javascript" src="../mespeakmaori/mespeakmaori.js"></script>

</head>

<body>

  <script>
    addEventListener('load', function(e) {

      cl = (line, arg) => {
        a = arg.split(" ")
        s = line + " "
        a.forEach(v => s = s + v + ": " + eval(v) + "  ")
        console.log(s)
      }

      makeObject = (array, names) => {
        o = {}
        names.map((v, i) => o[v] = array[i])
        return o
      }

      seed = Math.floor(Math.random() * (80 - 0 + 1) + 0)

      random = () => {
        x = Math.sin(seed++) * 10000
        return x - Math.floor(x)
      }
      randomRange = (min, max) => Math.floor(random() * (max - min + 1) + min)

      initialSeed = randomRange(0, 80)

      shuffle = (a, b) => random() - 0.5
      code = (n) => parseInt(n + "", 10).toString(9) * 1 + 11
      decode = (n) => parseInt((n - 11).toString(10), 9)

      //MODEL

      patternIndex = 0
      sentenceType = "question"
      substitutedWordIndex = 0
      englishSentenceText = " "
      maoriSentenceText = " "
      maoriAnswerText = "."
      gridWords = []
      sentenceCorrect = false
      pairingCode = "0000"
      pairing = false
      speaker = "host"
      words1 = []
      //englishWords = []
      //  maoriWords = []
      blankMaori = true
      //list=[]
      voices = false
      spoken = false

      patternsCSV = [
        // "what will the [animal] do,ka aha te [animal],the [animal] will [verb1],ka [verb1] te [animal]",
        // "what is the [animal] doing,kei te aha te [animal],the [animal] is [verb2],kei te [verb2] te [animal]",
        // "what has the [animal] done,kua aha te [animal],the [animal] has [verb3],kua [verb3] te [animal]",
        // "what did the [animal] do,i aha te [animal],the [animal] [verb4] -ed,i [verb4] te [animal]",
        // "what was the [animal] doing,i te aha [animal],the [animal] was [verb5] -ing,i te [verb5] te [animal]",

        // 1 BOOK 1 AOTEAROA
        "what is your name,ko wai tōu ingoa,my name is [maleName1],ko [maleName1] tōku ingoa",
        "where are you from,nō hea koe,I am from [place],nō [place] ahau",
        "how are you feeling (KT form),kei te pehea koe,I am feeling [stateOfMind],kei te [stateOfMind] ahau",
        "how are you feeling (EA form),e pehea ana koe,I am feeling [stateOfMindGood],e [stateOfMindGood] ana ahau",
        "how are you all feeling (EA form),e pehea ana koutou,we are feeling [stateOfMindBad],e [stateOfMindBad] ana mātou",

        // 6 BOOK 2 WHAKAPAPA
        "who is [femaleName1] 's [femaleRelationOfFemale],ko wai [femaleRelationOfFemale] a [femaleName1],the [femaleRelationOfFemale] of [femaleName1] is [femaleName2],ko [femaleName2] te [femaleRelationOfFemale] o [femaleName1]",
        "who is [femaleName1] 's [maleRelationOfFemale],ko wai [maleRelationOfFemale] a [femaleName1],the [maleRelationOfFemale] of [femaleName1] is [maleName2],ko [maleName2] te [maleRelationOfFemale] o [femaleName1]",
        "who is [maleName1] 's [femaleRelationOfmale],ko wai [femaleRelationOfmale] a [maleName1],the [femaleRelationOfmale] of [maleName1] is [femaleName2],ko [femaleName2] te [maleRelationOfFemale] o [maleName1]",
        "who is [maleName1] 's [maleRelationOfmale],ko wai [maleRelationOfmale] a [maleName1],the [maleRelationOfmale] of [maleName1] is [maleName2],ko [maleName2] te [maleRelationOfFemale] o [maleName1]",
        "who are your [relation]s,ko wai o [relation],my [relation]s are [maleName1] and [maleName2],ko [maleName1] rāua ko [femaleName1] ōku [relation]",
        "who are your [relation]s,ko wai o [relation],my [relation]s are [maleName1] [maleName2] and [femaleName2],ko [maleName1] rātou ko [maleName2] ko [femaleName2] ōku [relation]",
        "how many [relation] do you have,tokohia āu [relation],I have [numberRelations] [relation],[numberRelations] [relation]",

        // 11 BOOK 3 WAHI
        "what is that,he aha tēnā,this is a [animal],he [animal] tēnei",
        "what is that over there,he aha tērā,that over there is a [house],he [house] tērā",
        "what is this thing by me,he aha tēnei,that thing by you is a [transport],he [transport] tēnā",
        "what are these things by me,he aha ēnei,those things by you are [household1]-s,he [household1] ēnā",
        "what are those things,he aha ēnā,these are [food]-s,he [food] ēnei",
        "what are those over there,he aha ērā,those are [house]-s,he [house] ērā",
        "is that a [household],he [household] tēnā,[affirmation],[affirmation]",
        "what type of [animal] is this,he [animal] aha tēnei,that is a [colour] [animal],he [animal] [colour] tēnā",
        "where is [maleName1],kei hea a [maleName1],[maleName1] is [locative] the [house],kei [locative] a [maleName1] i te [house]",
        "where is the [food],kei hea te [food],the [food] is [locative] the [transport],kei [locative] te [food] i te [transport]",
        "where is your [household1],kei hea tōu [household1],my [household1] is [locative] the [household2],kei [locative] te [household2] tōku [household1]",
        "how many [kitchen]-s are there,e hia ngā [kitchen],there are [cardinal] [kitchen],[cardinal] ngā [kitchen]",

        // 23 BOOK 4 TE WA
        "what is the time,ko te aha te wa,the time is [time],ko te [time] te wa",
        "what day is it,ko te aha tēnei rā,the day is [day],ko te [day] tēnei rā",
        "what month is this,ko te aha tēnei marama,the month is [month],ko [month] tēnei marama",

        // 26 BOOK 5 MAHI NGAHAU
        "what are you doing,kei te aha koe,I am [moving],kei te [moving] ahau",
        "what are you two doing,kei te aha korua,we are [working],kei te [working] māua",
        "what are you three doing,kei te aha koutou,we are [exercising],kei te [exercising] mātou",
        "what are those 3 doing,kei te aha rātou,they are [meeting] in the [house],kei te [meeting] ki te [house]",
        "what are you and me going to do,ka aha māua,we will [moving],ka [moving] māua",
        "what did you two and me just do,kua aha mātou,we were [housekeeping],kua [housekeeping] mātou",
        "what did you do,i aha koe,I [functioning] -ed,i [functioning] ahau",
        "what were you two doing,i te aha kōrua,we were [learning],i te [learning]",
        "what will the [animal] do,ka aha te [animal],the [animal] will [communicating],ka [communicating] te [animal]",
        "what did [femaleName1] do,i aha [femaleName1],[femaleName1] [housekeeping] -ed the [room]",
        "how much does a [food] cost,e hia te utu mō te [food],[cost] is the cost of the [food],[cost] te utu mō te [food]",
        "how much does a [animal] cost,e hia te utu mō te [animal],[cost] is the cost of the [animal],[cost] te utu mō te [animal] ",

        // 39 BOOK 6 HAERENGA

        "where is he going,kei te haere ia ki hea,he is going to the [room],kei te haere ia ki [room]",
        "where will you go,ka haere koe ki hea,i will go to [place],ka haere ahau ki [place]",
        "where will you go and why are you going,ka haere ana koe ki hea ki te aha,I will go to [country] to [compoundNoun],ka haere ana ahau ki [country] ki te [compoundNoun]",
        "where will you go and why are you going,ka haere ana koe ki hea ki te aha,I will go to [room] to [compoundNoun],ka haere ana ahau ki [room] ki te [compoundNoun]",
        "how will you travel,mā hea koe haere ai,i will travel by [transport],mā runga [transport] ahau haere ai",

        // 45 BOOK 7 TIKANGA MARAE
        "the [maraePeople1] [welcoming1],ka [welcoming1] te [maraePeople1],then the [maraePeople2] [welcoming2],kātahi ka [welcoming2] te [maraePeople2]",
        "the [maraePeople1] [welcoming1],ka [welcoming1] te [maraePeople1],after that the [maraePeople2] [welcoming2],a muri i tērā ka [welcoming2] te [maraePeople2]",

      ]

      tupuCSV = [

        //PRONOUNS

        "pronoun,I/me,ahau",
        "pronoun,you,koe",
        "pronoun,him/her,ia",
        "pronoun,us (2),tāua",
        "pronoun,us (3+),tātou",
        "pronoun,we (2 but not you),māua",
        "pronoun,we (3+ but not you),mātou",
        "pronoun,you (2),kōrua",
        "pronoun,you (3+),koutou",
        "pronoun,them (2),rāua",
        "pronoun,them (3+),rātou",

        "possessiveSingluar,my,tōku",
        "possessiveSingluar,your,tōu",
        "possessiveSingluar,their,tōna",

        "possessivePlural,my,ōku",
        "possessivePlural,your,ōu",
        "possessivePlural,their,ōna",

        "npronoun,I,nāku",
        "npronoun,you,nāu",
        "npronoun,he or she,nāna",

        //NOUNS PROPER

        "name,fred,fred",

        "maleName1,Mikaere,Mikaere",
        "maleName1,Hoani,Hoani",
        "maleName1,Pita,Pita",
        "maleName1,Matiu,Matiu",

        "maleName2,Hemi,Hemi",
        "maleName2,Wiremu,Wiremu",
        "maleName2,Rawiri,Rawiri",
        "maleName2,Nikau,Nikau",
        "maleName2,Ihaka,Ihaka",

        "femaleName1,Mere,Mere",
        "femaleName1,Hine,Hine",
        "femaleName1,Aroha,Aroha",
        "femaleName1,Kara,Kara",

        "femaleName2,hinemoa,hinemoa",
        "femaleName2,Kahurangi,Kahurangi",
        "femaleName2,Ngaio,Ngaio",
        "femaleName2,Rehua,Rehua",

        "genderNeutralName,Mikaere,Mikaere",


        "place,Dunedin,Onetāhi",
        "place,Auckland,Tamaki Makaurau",
        "place,One Tree Hill,Maungakiekie",
        "place,New Plymouth,Ngāmotu",
        "place,Christchurch,Ōtautahi",
        "place,Taupō,Taupō-nui-a-Tia",
        "place,Tauranga,Tauranga-moana",
        "place,Kaikoura,Te_Ahi-kai-kōura-a-Tama-ki-te-rangi",
        "place,Hokianga,Te_Hokianga-a-Kupe",
        "place,Wellington,Te_Whanga-nui-a-Tara",
        "place,Nelson,Whakatū",
        "place,Gisborne,Tūranga-nui-a-Kiwa",
        "place,Napier,Ahuriri",
        "place,Palmerston North,Te_Papaioea",
        "place,Otago,Ōtakou",


        "country,australia,ahitereiria",
        "country,england,ingarangi",
        "country,america,amerika",
        "country,south africa,āwherika ki te tonga",
        "country,africa,āwherika",
        "country,italy,itāria",
        "country,china,haina",
        "country,france,wīwī",
        "country,asia,āhia",
        "country,europe,ūropi",

        //NOUNS COMMON


        "maleRelationOfMale,father,matua",
        "maleRelationOfMale,younger brother,teina",
        "maleRelationOfMale,son,tama",
        "maleRelationOfMale,older brother,tuakana",
        "maleRelationOfMale,grandfather,matua tūpuna",

        "femaleRelationOfMale,girl friend,hoa_wahine",
        "femaleRelationOfMale,aunty,whaea kēkē",
        "femaleRelationOfMale,grandmother,whaea tūpuna",
        "femaleRelationOfMale,mother,whaea",
        "femaleRelationOfMale,sister,tuāhine",

        "femaleRelationOfFemale,mother,whaea",
        "femaleRelationOfFemale,daughter,tamāhine",
        "femaleRelationOfFemale,girl friend,hoa_wahine",
        "femaleRelationOfFemale,aunty,whaea kēkē",
        "femaleRelationOfFemale,grandmother,whaea tūpuna",
        "femaleRelationOfFemale,younger sister,teina",
        "femaleRelationOfFemale,older sister,tuakana",

        "maleRelationOfFemale,brother,tungāne",
        "maleRelationOfFemale,uncle,matua kēkē",
        "maleRelationOfFemale,grandfather,matua tūpuna",
        "maleRelationOfFemale,father,matua",

        "relation,grandchildren,mokopuna",
        "relation,children,tamariki",
        "relation,child,tamaiti",
        "relation,niece or nephew,irāmutu",
        "relation,cousin,kaihanga",

        "people,child,tamaiti",
        "people,man,tane",
        "people,woman,wahine",
        "people,teacher,kaiako",
        "people,student,tauira",
        "people,old woman,kuia",
        "people,old man,korua",
        "people,girl,kōtiro",
        "people,boy,tama",

        "marae,shake hands,harirū",
        "marae,is that so,meinga_meinga",
        "marae,carving,whakairo",
        "marae,carving on roof,tekoteko",
        "marae,carving,whakairo",
        "marae,formal speech,whaikõrero",



        "maraePeople1,old lady,kuia",
        "maraePeople1,old man,korua",
        "maraePeople1,hosts,tangata whenua",
        "maraePeople1,visitors,manuhire",

        "maraePeople2,man,tane",
        "maraePeople2,girl,kōtiro",
        "maraePeople2,cooks,ringawera",
        "maraePeople2,speaker,kaikōrero",

        "animal,dog,kurī",
        "animal,sheep,hipi",
        "animal,chicken,heihei",
        "animal,duck,rakiraki",
        "animal,pig,poaka",
        "animal,cat,ngeru",
        "animal,cow,kau",
        "animal,horse,hōiho",
        "animal,goat,nanekoti",

        "transport,canoe,waka",
        "transport,bus,pahi",
        "transport,train,tereina",
        "transport,helicopter,wakatopatopa",
        "transport,truck,taraka",
        "transport,bicycle,paihikara",
        "transport,car,motoka",
        "transport,horse,hōiho",
        "transport,boat,waka_poti",
        "transport,plane,waka_rererangi",
        "transport,scooter,huta",

        "food,egg,hēki",
        "food,pen,pene",
        "food,seafood,kaimoana",
        "food,vegetables,hua_whenua",
        "food,fruit,hua_rākau",
        "food,butter,pata",
        "food,cream,kirīmi",
        "food,apple,āporo",
        "food,milk,miraka",
        "food,bread loaf,paraoa",
        "food,banana,panana",
        "food,lolly,rare",

        "clothing,T-shirt,ti hate",
        "clothing,hat,potae",
        "clothing,shoes,hu",


        "house,floor,papa",
        "house,ceiling,tuanui",
        "house,wall,pakitara",
        "house,window,matapihi",
        "house,door,kuaha",
        "house,home,kāinga",
        "house,tree,rākau",


        "room,kitchen,kīhini",
        "room,lounge,rūma_noho",
        "room,bedroom,rūma_moe",
        "room,bathroom,rūma_horoi_tinana",
        "room,shed,wharau",

        "household1,broom,paruma",
        "household1,chair,tūru",
        "household1,table,tēpu",
        "household1,lamp,rama",
        "household1,phone,waea_kōrero",
        "household1,bed,moenga",
        "household1,pen,pene",
        "household1,book,pukapuka",


        "household2,TV,pouaka_whakaata",
        "household2,bag,kete",
        "household2,freezer,pouaka_tio",
        "household2,fridge,poaka_makariri",
        "household2,bathtub,tāpu",
        "household2,shower,uwhi",
        "household2,cup,kapu",
        "household2,drawer,toroa",
        "household2,washing machine,mīhini_horoi_kakahu",

        "body,nose,ihu",
        "body,neck,kakī",
        "body,tongue,arero",
        "body,chin,kauae",
        "body,hair,māhunga",
        "body,heart,manawa",
        "body,teeth,niho",
        "body,chest,poho",
        "body,belly,puku,",
        "body,hand,ringa",
        "body,head,upoko",
        "body,leg,waewae",
        "body,breast,ū",
        "body,penis,ure",
        "body,vagina,tenetene",
        "body,knee,turi",

        "kitchen,frying pan,parai",
        "kitchen,knife,ripi",
        "kitchen,oven,ōmu",
        "kitchen,ladle,kōtutu",
        "kitchen,pot,kōhua",
        "kitchen,serviette,parehūhare",
        "kitchen,spoon,koko",
        "kitchen,tea towel,tītaora",
        "kitchen,tongs,pīnohi",
        "kitchen,serving platter,paepae_mahora",
        "kitchen,plastic wrap,takai_kirihou",
        "kitchen,hob,mura",
        "kitchen,plate,pereti",

        //ADJECTIVES

        "adjectives1,beautiful,ātaahua",
        "adjectives1,big,nui",
        "adjectives1,long,roa",
        "adjectives1,small,iti",
        "adjectives1,old,tawhito",
        "adjectives1,new,hōu",
        "adjectives1,ugly,anuhea",
        "adjectives1,scared,mataku",
        "adjectives1,sad,pouri",
        "adjectives1,lonely,mokemoke",
        "adjectives1,hot,wera",
        "adjectives1,warm,mahana",
        "adjectives1,cold,makariri",

        "adjectives2,quick,horo",
        "adjectives2,fast,tere",
        "adjectives2,slow,pōturi",
        "adjectives2,fat,mōmona",
        "adjectives2,skinny,tūpuhi",
        "adjectives2,tall,tāroroa",
        "adjectives2,thin,angiangi",
        "adjectives2,wide,whānui",
        "adjectives2,thick,mātotoru",
        "adjectives2,few,torutoru",
        "adjectives2,many,maha",
        "adjectives2,shiny,pīata",
        "adjectives2,dull,pūhuki",

        "personal qualities 1,lazy,māngere",
        "personal qualities 1,expert,tohunga",
        "personal qualities 1,knowledgeable,mātau",
        "personal qualities 1,brave,toa",
        "personal qualities 1,entertaining,ngahau",
        "personal qualities 1,weak,ngoikore",
        "personal qualities 1,all right,āhau pai",
        "personal qualities 1,pleasant person,ngākau māhaki",
        "personal qualities 1,quiet,nohopuku",

        "personal qualities 2,faithful,ngākau nui",
        "personal qualities 2,amusing,hātakēhi",
        "personal qualities 2,quick,kakama",
        "personal qualities 2,industrious,pukumahi",
        "personal qualities 2,intelligent,koi te hinengaro",
        "personal qualities 2,ignorant,kūare",
        "personal qualities 2,very good,tino pai",
        "personal qualities 2,generous,marae",
        "personal qualities 2,fabulous,tino rawe",
        "personal qualities 2,serene,mauritau",


        //VERBS ACTION

        "moving,run,oma",
        "moving,come,haere",
        "moving,walking,hīkoi",
        "moving,dance,kanikani",
        "moving,climb,piki",
        "moving,stand,tū",
        "moving,come,kuhu",
        "moving,come down,heke",
        "moving,exit,puta",
        "moving,wait,taihoa",
        "moving,jump,peke",
        "moving,return,hoki",
        "moving,sit,noho",
        "moving,swim,kauhoe",
        "moving,rest,whakatā",

        "performing,singing,waiata",
        "performing,talk,kōrero",
        "performing,clap,pakipaki",
        "performing,paint,peita",
        "performing,weave,raranga",
        "performing,carve,whakairo",

        "learning,read,pānui",
        "learning,learn,ako",
        "learning,understand,mārama",
        "learning,remember,māharahara",
        "learning,answer,whakautu",
        "learning,teach,akona",
        "learning,think,whakaaro",
        "learning,question,patai",
        "learning,know,mōhio",
        "learning,write,tuhi",

        "meeting,cry,tangi",
        "meeting,laugh,katakata",
        "meeting,smile,menemene",
        "meeting,embrace,awhiawhi",
        "meeting,greet,mihi",
        "meeting,call,karanga",
        "meeting,kiss,kihi",

        "functioning,eating,kai",
        "functioning,sleeping,moe",
        "functioning,drink,inu",
        "functioning,feed,whāngai",
        "functioning,snore,ngōngoro",
        "functioning,yawn,hītako",
        "functioning,sneeze,matihe",
        "functioning,burp,kūpa",
        "functioning,cough,mapu",
        "functioning,dream,moemoeā",
        "functioning,lie down,tāpapa",
        "functioning,fart,patero",

        "working,work,mahi",
        "working,carry,hari",
        "working,purchase,hoko",
        "working,build,hanga",
        "working,lift,hiki",
        "working,fix,whakatika",
        "working,take off,tango",

        "communicating,shout,ūmere",
        "communicating,pray,inoi",
        "communicating,argue,whawhai",
        "communicating,write,tuhi",
        "communicating,listen,whakarongo",
        "communicating,look,titro",
        "communicating,watch,mātakitaki",
        "communicating,see,kite",

        "housekeeping,cook,tunu",
        "housekeeping,gather,tiki",
        "housekeeping,buy,utu",
        "housekeeping,cut,tapahi",
        "housekeeping,wash,horoi",
        "housekeeping,tidy,whakapai",
        "housekeeping,dry,whakamaroke",
        "housekeeping,sweep,tahitahi",
        "housekeeping,pull weeds,huhuti_taru",
        "housekeeping,mow,tapahi_karaehe",
        "housekeeping,vacuum,whakangote_puehu",
        "housekeeping,hang up,whakairi",

        "exercising,throw,whiu",
        "exercising,chase,whai",
        "exercising,stretch,whātoro",
        "exercising,pull,kukume",
        "exercising,touch,pā",
        "exercising,push,pana",
        "exercising,shake,rūrū",
        "exercising,bend,piko",
        "exercising,wait,tatari",


        "welcoming1,gift,koha",
        "welcoming1,gathering,hui",
        "welcoming1,support sing,waiata_tautoko",
        "welcoming1,greet,mihi",
        "welcoming1,dance,haka pōhiri",

        "welcoming2,handshake,hariru",
        "welcoming2,call,karanga",
        "welcoming2,challenge,wero",
        "welcoming2,call for food,karanga mō te kai",
        "welcoming2,prayer for food,karakia mō te kai",
        "welcoming2,food,kai",

        //reasons for travel
        "compoundNoun,get food,tiki kai",
        "compoundNoun,sight seeing,titiro haere",
        "compoundNoun,buy food,hoko kai",
        "compoundNoun,buy presents,hoko taonga",
        "compoundNoun,play sports,tākaro hākinakina",
        "compoundNoun,meet relations,tūtaki whanaunga",
        "compoundNoun,find work,kimi mahi",


        "verb5,send,tono",

        "verb6,rip,tīhae",



        "verb6,search,kimi/rapu",
        "verb6,point,tohu",

        "verb6,erase,ūkui",
        "verb6,turn off,whakaweto",
        "verb6,fall off,taka",
        "verb6,hurt,whakamāmae",
        "verb6,slap,paki",

        //VERBS STATIVES

        "stateOfBody,sleepy,hiamoe",
        "stateOfBody,hot,wera",
        "stateOfBody,cold,makariri",
        "stateOfBody,good,pai",
        "stateOfBody,tired,ngēngē",
        "stateOfBody,thirsty,hiainu",
        "stateOfBody,well,ora",
        "stateOfBody,hungry,hiakai",

        "feeling,sharp,koi",

        "stateOfMind,bored,hōhā",
        "stateOfMind,surprised,ohorere",
        "stateOfMind,confused,rangirua",
        "stateOfMind,sad,pōuri",
        "stateOfMind,lazy,māngere",
        "stateOfMind,scared,mataku",
        "stateOfMind,confused,kutekute",

        "stateOfMindGood,pleased,waingohia",
        "stateOfMindGood,correct,tika",
        "stateOfMindGood,overjoyed,harikoa",
        "stateOfMindGood,happy,hari",
        "stateOfMindGood,pleased,waingohia",

        "stateOfMindBad,furious,pukuriri",
        "stateOfMindBad,lost,ngaro",
        "stateOfMindBad,arrogant,whakahīhī",
        "stateOfMindBad,angry,riri",
        "stateOfMindBad,worried,āwangawanga",
        "stateOfMindBad,bad,kino",
        "stateOfMindBad,wrong,ku_to_he",
        "stateOfMindBad,annoyed,whakahohā",

        "cardinal,none,kāore",
        "cardinal,one,kotahi",
        "cardinal,two,e rua",
        "cardinal,three,e toru",
        "cardinal,four,e wha",
        "cardinal,five,e rima",
        "cardinal,six,e ona",
        "cardinal,seven,e whitu",
        "cardinal,eight,e waru",
        "cardinal,nine,e iwa",

        "numberRelations,none,kāore āku",
        "numberRelations,one,kotahi tāku",
        "numberRelations,two,tokorua āku",
        "numberRelations,three,tokotoru āku",

        "affirmation,yes,ae",
        "affirmation,no,kahore",

        "colour,white,mā",
        "colour,red,whero",
        "colour,orange,karaka",
        "colour,yellow,kōwhai",
        "colour,green,kākāriki",
        "colour,black,mangu",
        "colour,blue,kikorangi",
        "colour,purple,waiporoporo",
        "colour,brown,parauri",
        "colour,grey,kiwikiwi",

        "time,2:10,tekau mai i te rua",
        "time,3:30,haurua mai i te toru",
        "time,12:45,hauwha ki te tahi",
        "time,4:50,tekau ki te rima",
        "time,8:24,rua tekau mai i te waru",

        "day,Monday,Rāhina",
        "day,Tuesday,Rātū",
        "day,Wednesday,Rāapa",
        "day,Thursday,Rāpare",
        "day,Friday,Rāmere",
        "day,Saturday,Rāhoroi",
        "day,Sunday,Rātapu",

        "month,January,Kohitātea",
        "month,February,Hui-tanguru",
        "month,March,Poutū-te-rangi",
        "month,April,Paenga-whāwhā",
        "month,May,Haratua",
        "month,June,Pipiri",
        "month,July,Hōngongoi",
        "month,August,Here-turi-kōkā",
        "month,September,Mahuru",
        "month,October,Whiringa-ā-nuku",
        "month,November,Whiringa-ā-rangi",
        "month,December,Hakihea",

        "locative,under,raro",
        "locative,on,runga",
        "locative,outside,waho",
        "locative,inside,roto",
        "locative,behind,muri",
        "locative,in front,mua",
        "locative,between,waenganui",
        "locative,here by me,konei",
        "locative,there by you,konā",
        "locative,over there by them,korā",
        "locative,overseas,tāwāhi",
        "locative,right side,taha matau",
        "locative,left side,taha mauī",

        "command,stand up,e tū",
        "command,sit down,e noho",
        "command,give back,homai",



        "tense,am/are,kei te",
        "tense,will,ka",
        "tense,has just,kua",
        "tense,had,i",
        "tense,was,i te",


        "cost,$3.25,toru tāra e rua tekau mā rima hēneti",
        "cost,$1.73,kotahi tāra e whitu tekau mā toru hēneti",
        "cost,$38.69,e toru tekau mā waru tāra e ona tekau mā iwa hēneti",
        "cost,$403.52,e wha rau e toru tāra e rima tekau mā rua hēneti",

      ]

      patterns = []
      patternsCSV.forEach(v => patterns.push(makeObject(v.split(","), ["englishQ", "maoriQ", "englishA", "maoriA"])))

      tupus = []
      tupuCSV.forEach(v => tupus.push(makeObject(v.split(","), ["topic", "english", "maori"])))

      patternList = [...patterns.map(p => p.englishQ)]
      //console.log(patternList)
      vocabList = [...new Set([...tupus.map(t => t.topic)])]
      //console.log(vocabList)

      seed = initialSeed
      tupusOriginal = [...tupus]
      tupus.sort(shuffle)
      //  cl("after sort", "initialSeed tupus[0].english tupusOriginal[0].english")

      substituteEnglishVariableWord = (str) => {
        variableWord = str.match(/\[(\w+)\]/g)
        s = str
        if (variableWord != null) {
          variableWord.forEach((item) => {
            item = item.replace("[", "").replace("]", "")
            variableWords = tupus.filter(v => (v.topic == item))
            s = s.replace("[" + item + "]", variableWords[substitutedWordIndex % variableWords.length].english)
          })
        }
        return s
      }

      substituteMaoriVariableWord = (str) => {
        variableWord = str.match(/\[(\w+)\]/g)
        s = str
        if (variableWord != null) {
          variableWord.forEach((item) => {
            item = item.replace("[", "").replace("]", "")
            variableWords = tupus.filter(v => (v.topic == item))
            s = s.replace("[" + item + "]", variableWords[substitutedWordIndex % variableWords.length].maori)
          })
        }
        return s
      }

      //  substitutedWordIndex = (substitutedWordIndex == tupus.filter(v => v.topic == variableWord[1]).length) ? 0 : substitutedWordIndex++


      makeSentences = (patternIndex) => {

        if (sentenceType == "question") {
          englishSentenceText = (speaker == "host") ? substituteEnglishVariableWord(patterns[patternIndex].englishQ) : "type what you hear"
          maoriSentenceText = substituteMaoriVariableWord(patterns[patternIndex].maoriQ)
        } else {
          englishSentenceText = ((speaker == "host") && pairing) ? englishSentenceText = substituteEnglishVariableWord(patterns[patternIndex].englishA) : "type what you hear"
          maoriSentenceText = substituteMaoriVariableWord(patterns[patternIndex].maoriA)
        }
        if ((speaker == "guest") && pairing && voices && !spoken) {
          //alert(maoriSentenceText)
          spoken = true
          mespeakmaori(maoriSentenceText.toLowerCase())
        }
      }

      maoriWordList = () => {
        wordList = []
        patterns.forEach(v => wordList = [...wordList, ...v.maoriQ.replace(/ \[(\w+)\]/g, "").split(" ")])
        //cl("maoriWordList from questions", "wordList")
        //list = list.sort(shuffle)
        wordList = [...new Set(wordList)]
        return wordList
      }

      topicWordList = () => {
        wordList = []
        str = (sentenceType == "question") ? patterns[patternIndex].englishQ : patterns[patternIndex].englishA
        variableWord = str.match(/\[(\w+)\]/)
        if (variableWord != null) {
          tupus.filter(v => v.topic == variableWord[1]).forEach(v => wordList = [...wordList, ...v.maori.split(" ")])
        }
        //list = list.sort(shuffle)

        //  cl("list of topic words", "wordList")
        return wordList
      }

      makeGridWords = () => {
        requiredWords = maoriSentenceText.replace(/\[(\w+)\]/, "").split(" ")
        words = [...maoriWordList().slice(0, 20 - Math.min(6, topicWordList().length)), ...topicWordList().slice(0, 6)]
        words = [...words.slice(0, 24 - requiredWords.length), ...requiredWords]
        words = [...new Set(words)]
        words = words.sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()))
        gridWords = words
      }

      updateModel = () => {
        makeSentences(patternIndex)
        makeGridWords()
      }

      updateVocab = () => {
        a = []
        words1.sort(shuffle)
        words1.forEach((v, i) => {
          a.push(words1[i].english)
          a.push(words1[i].maori)
        })
        //console.log(a)
        return a
      }

      //VIEW

      addElement = (id, elementType, container, width, style, text) => {
        element = document.createElement(elementType)
        element.style.cssText = style
        element.style.width = width + "%"
        element.id = id
        element.innerHTML = text
        container.appendChild(element)
        return element
      }
      style = "color:white;background:black;border-style:solid;border-width:1px;font-size:2vw;font-family:verdana;"
      buttonStyle = style + "position:relative;height:5vw;text-align:center;"
      buttonLeftStyle = buttonStyle + "position:relative;float:left;text-align:center;"
      buttonRightStyle = buttonStyle + "position:relative;right:0;text-align:center;"
      listStyle = buttonStyle + "position:relative;right:0;text-align:left;"
      divStyle = style + "position:relative;text-align:left;display:block;"
      correctButtonStyle = buttonStyle + "color:limeGreen;"
      hiddenButtonStyle = buttonStyle + "color:black;font-size:2vw;"
      revealedButtonStyle = buttonStyle + "width:25%;font-size:2vw;"

      display = () => { //enter maori text
        updateModel()
        document.body.style.cssText = "background:black;"
        document.body.innerHTML = ""
        b = addElement(1, "div", document.body, 100, "", "")
        b.addEventListener("click", clicked)

        navigationDiv = addElement("navigationDiv", "div", b, 100, divStyle, "")
        pairingButton = addElement("pairingButton", "button", navigationDiv, 16, buttonLeftStyle, "korero")
        redoButton = addElement("redoButton", "button", navigationDiv, 16, buttonRightStyle, pairing ? ". " : "kupu hou")
        patternListButton = addElement("patternListButton", "button", navigationDiv, 16, buttonRightStyle, pairing ? ". " : "structs")
        vocabListButton = addElement("vocabListButton", "button", navigationDiv, 16, buttonRightStyle, pairing ? ". " : "vocab")
        prevPatternButton = addElement("prevPatternButton", "button", navigationDiv, 16, buttonRightStyle, pairing ? " ." : "prev")
        nextPatternButton = addElement("nextPatternButton", "button", navigationDiv, 20, buttonRightStyle, "next") //"&#x25B6;")

        englishDiv = addElement("englishDiv", "div", b, 100, divStyle, "")
        englishSentence = addElement("englishSentence", "button", englishDiv, 93, buttonStyle, englishSentenceText) //patternIndex + 1 + ". " +
        sayAgain = addElement("sayAgain", "button", englishDiv, 7, buttonStyle, "say") //patternIndex + 1 + ". " +

        maoriDiv = addElement("maoriDiv", "div", b, 100, divStyle, "")
        maoriSentenceElement = addElement("maoriSentence", "button", maoriDiv, 93, sentenceCorrect ? correctButtonStyle : buttonStyle, maoriAnswerText)
        deleteButton = addElement("deleteButton", "button", maoriDiv, 7, buttonRightStyle, "del") //"&#x232B;")

        wordGrid = addElement("wordGrid", "div", b, 100, divStyle, "")
        gridWords.forEach((v, i) => addElement("tupu" + i, "button", wordGrid, 25, buttonStyle, v))
      }

      displayWordlist = () => { // show english and maori words
        vocabWords = updateVocab()
        document.body.style.cssText = "background:black;"
        document.body.innerHTML = ""
        b = addElement(1, "div", document.body, 100, "", "")
        b.addEventListener("click", clicked)
        wordlistDiv = addElement("wordlistDiv", "div", b, 100, divStyle, "")
        sortVocabListButton = addElement("sortVocabListButton", "button", wordlistDiv, 33, buttonRightStyle, "random")
        switchVocabListButton = addElement("switchVocabListButton", "button", wordlistDiv, 33, buttonRightStyle, "switch")
        closeButton = addElement("closeButton", "button", wordlistDiv, 34, buttonRightStyle, "close")
        wordGrid = addElement("wordGrid", "div", b, 100, divStyle, "")
        vocabWords.forEach((v, i) => addElement("word" + i, "button", wordGrid, 25, i % 2 == (blankMaori ? 0 : 1) ? buttonStyle : hiddenButtonStyle, v))
      }

      displayPatternList = () => { // show all the sentence patterns
        document.body.style.cssText = "background:black;"
        document.body.innerHTML = ""
        b = addElement(1, "div", document.body, 100, "", "")
        b.addEventListener("click", clicked)
        patternListDiv = addElement("patternListDiv", "div", b, 100, divStyle, "")
        closePatternListButton = addElement("closePatternListButton", "button", patternListDiv, 100, buttonRightStyle, "close")
        patternGrid = addElement("patternGrid", "div", b, 100, divStyle, "")
        //console.log("patternList :  " + patternList)
        patternList.forEach((v, i) => addElement("patternListIndex" + i, "button", patternGrid, 100, listStyle, v))
      }

      displayVocabList = () => { // show a list of all the vocab groups
        document.body.style.cssText = "background:black;"
        document.body.innerHTML = ""
        b = addElement(1, "div", document.body, 100, "", "")
        b.addEventListener("click", clicked)
        vocabListDiv = addElement("vocabListDiv", "div", b, 100, divStyle, "")
        closeVocabListButton = addElement("closeVocabListButton", "button", vocabListDiv, 100, buttonRightStyle, "close")
        vocabGrid = addElement("vocabGrid", "div", b, 100, divStyle, "")
        vocabList.forEach((v, i) => addElement("vocabListIndex" + i, "button", vocabGrid, 100, listStyle, v))
      }

      displayStructure = (str) => { // show the maori translation
        document.body.style.cssText = "background:black;"
        document.body.innerHTML = ""
        b = addElement(1, "div", document.body, 100, "", "")
        b.addEventListener("click", clicked)
        wordlistDiv = addElement("wordlistDiv", "div", b, 100, divStyle, "")
        closeButton = addElement("closeButton", "button", wordlistDiv, 100, buttonRightStyle, "close")
        structureDiv = addElement("structureDiv", "button", wordlistDiv, 100, buttonStyle, str)
      }

      displayPairing = () => {
        document.body.style.cssText = "background:black;"
        document.body.innerHTML = ""
        b = addElement(1, "div", document.body, 100, "", "")
        b.addEventListener("click", clicked)
        voicesDiv = addElement("voicesDiv", "button", b, 100, buttonLeftStyle, "Pair with Hine")
        instructionsDiv = addElement("instructionsDiv", "button", b, 100, buttonLeftStyle, "Share code below or enter pairing code and click OK")
        pairingCodeButton = addElement("pairingCodeButton", "button", instructionsDiv, 100, buttonStyle, pairingCode)
        a = [1, 2, 3, 4, 5, 6, 7, 8, 9]
        a.forEach((v, i) => addElement("keyButton" + v, "button", instructionsDiv, 30, buttonStyle, v))
        acceptButton = addElement("acceptButton", "button", instructionsDiv, 50, buttonLeftStyle, "OK")
        cancelButton = addElement("cancelButton", "button", instructionsDiv, 50, buttonRightStyle, "Cancel")
      }

      //CONTROLLER

      clicked = e => {
        id = e.target.id
        element = e.target

        if (id == "nextPatternButton") {
          spoken = false


          //if the the first (host) speaker has just asked a question then they must answer the next
          if (speaker == "host" && sentenceType == "question") {
            newspeaker = "guest"
            newsentenceType = "answer"
          }
          if (speaker == "guest" && sentenceType == "answer") {
            newspeaker = "guest"
            newsentenceType = "question"
          }
          if (speaker == "guest" && sentenceType == "question") {
            newspeaker = "host"
            newsentenceType = "answer"
          }
          if (speaker == "host" && sentenceType == "answer") {
            newspeaker = "host"
            newsentenceType = "question"
          }
          speaker = newspeaker
          sentenceType = newsentenceType

          console.log("pairing: " + pairing, "speaker: " + speaker, "sentenceType: " + sentenceType, "voices: " + voices, "spoken: " + spoken)


          if (sentenceType == "question") {
            patternIndex = (patternIndex == patterns.length - 1) ? 0 : patternIndex + 1
            //sentenceType = "question"
          }
          maoriAnswerText = "."
          sentenceCorrect = false
          makeGridWords()
          display()
        }

        if (id == "prevPatternButton") {
          question = true
          patternIndex = (patternIndex == 0) ? 0 : patternIndex - 1
          maoriAnswerText = "."
          sentenceCorrect = false
          display()
        }

        if (id == "patternListButton") {
          displayPatternList()
        }

        if (id.includes("patternListIndex")) {
          patternIndex = element.id.match(/\d+/)
          display()
        }

        if (id == "closePatternListButton") {
          display()
        }

        if (id == "vocabListButton") {
          displayVocabList()
        }

        if (id.includes("vocabListIndex")) {
          variableWord = [element.innerHTML]
          words1 = []
          if (variableWord != null) {
            variableWord.forEach((item) => {
              variableWords = tupus.filter(v => (v.topic == item))
              wordList = tupus.filter(v => (v.topic == item))
              wordList.forEach(v => {
                word2 = {}
                word2.english = v.english
                word2.maori = v.maori
                words1.push(word2)
              })
            })
          }
          displayWordlist()
        }

        if (id == "sortVocabListButton") {
          displayWordlist()
        }

        if (id == "switchVocabListButton") {
          blankMaori = !blankMaori
          displayWordlist()
        }

        if (id == "closeVocabListButton") {
          display()
        }

        if (id == "englishSentence") {
          variableWord = patterns[patternIndex].englishA.match(/\[(\w+)\]/g)
          //englishWords = []
          //maoriWords = []
          words1 = []
          if (variableWord != null) {
            variableWord.forEach((item) => {
              item = item.replace("[", "").replace("]", "")
              variableWords = tupus.filter(v => (v.topic == item))
              wordList = tupus.filter(v => (v.topic == item))
              wordList.forEach(v => {
                //  englishWords.push(v.english)
                //  maoriWords.push(v.maori)
                word2 = {}
                word2.english = v.english
                word2.maori = v.maori
                words1.push(word2)
              })
            })
          }
          displayWordlist()

        }


        if (id == "closeButton") {
          display()
        }

        if (id.includes("word")) {
          (element.style.color == "black") ? element.style.color = "white": element.style.color = "black"
        }

        if (id == "deleteButton") {
          maoriAnswerText = maoriAnswerText.substring(0, maoriAnswerText.lastIndexOf(" "))
          sentenceCorrect = false
          display()
        }

        if (id == "redoButton") {
          maoriAnswerText = "."
          substitutedWordIndex++
          sentenceCorrect = false
          display()
        }

        if (id == "maoriSentence") {
          displayStructure(maoriSentenceText) // + "<br><br>")
        }

        if (id.includes("tupu")) {
          maoriAnswerText = maoriAnswerText + " " + gridWords[id.match(/\d+/g)]
          maoriAnswerText = maoriAnswerText.replace(".", "")
          if (maoriAnswerText.trim() == substituteMaoriVariableWord(patterns[patternIndex].maoriQ) ||
            maoriAnswerText.trim() == substituteMaoriVariableWord(patterns[patternIndex].maoriA))
            sentenceCorrect = true
          display()
        }

        if (id == "pairingButton") {
          pairingCode = code(initialSeed) + code(patternIndex).toString()
          displayPairing()
        }

        if (id == "voicesDiv") {
          voices = true
          pairing = true
          display()
        }

        if (id == "sayAgain") {
          mespeakmaori(maoriSentenceText.toLowerCase())
        }

        if (id.includes("keyButton")) {
          if (pairingCode.length == 4) pairingCode = ""
          firstSpeaker = false
          if (pairingCode.length < 4) {
            pairingCode = pairingCode + id.match(/\d+/g)
          }
          patternIndex = decode(pairingCode.slice(2))
          initialSeed = decode(pairingCode.slice(0, 2))
          displayPairing()
        }

        if (id == "acceptButton") {
          initialSeed = decode(pairingCode.slice(0, 2))
          seed = initialSeed
          tupus = [...tupusOriginal]
          tupus.sort(shuffle)
          //cl("after accept sort", "pairingCode initialSeed tupus[0].english")
          pairing = true
          display()
        }

        if (id == "cancelButton") {
          pairing = false
          display()
        }
      }

      display()
    })
  </script>
</body>

</html>
